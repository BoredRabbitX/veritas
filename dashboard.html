<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Business Dashboard | Veritas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-gray-50 p-8">
    <div class="max-w-md mx-auto bg-white p-8 rounded-3xl shadow-xl">
        <a href="index.html" class="text-blue-600 text-sm font-medium mb-6 inline-block">‚Üê Back to Home</a>
        <h2 class="text-2xl font-bold mb-2">Merchant Portal</h2>
        <p class="text-gray-500 text-sm mb-6">Generate a unique QR code for your customer's receipt.</p>

        <div class="space-y-4">
            <input id="receiptId" type="text" placeholder="Receipt ID (e.g., #1024)" class="w-full p-4 bg-gray-50 border rounded-xl outline-none focus:ring-2 focus:ring-blue-500">
            <button onclick="generateQR()" class="w-full bg-blue-600 text-white py-4 rounded-xl font-bold shadow-lg hover:bg-blue-700 transition">Generate Review QR</button>
        </div>
        
        <div id="qrcode" class="mt-8 flex justify-center"></div>
        <div id="qrHelp" class="mt-6 text-center hidden">
            <p class="text-sm font-medium text-gray-800">Ready to Scan!</p>
            <p class="text-xs text-gray-400">Show this to your customer to receive a verified review.</p>
        </div>
    </div>

    <script>
        function generateQR() {
            const id = document.getElementById('receiptId').value;
            if(!id) return alert("Please enter a Receipt ID");
            
            const qrContainer = document.getElementById('qrcode');
            qrContainer.innerHTML = "";
            
            // Note: In production, fetch the merchant address from the connected wallet
            const merchantAddr = "0xb3dc45518cc51c759193da59772a407dad584852"; 
            const url = `${window.location.origin}/veritas/review.html?business=${merchantAddr}&receipt=${encodeURIComponent(id)}`;
            
            new QRCode(qrContainer, {
                text: url,
                width: 200,
                height: 200,
                colorDark : "#2563eb",
                colorLight : "#ffffff",
                correctLevel : QRCode.CorrectLevel.H
            });
            document.getElementById('qrHelp').classList.remove('hidden');
        }
    </script>
</body>
</html>
